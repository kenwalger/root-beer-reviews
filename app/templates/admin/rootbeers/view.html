{% extends "admin/base.html" %}

{% block content %}
<div class="mb-6 flex justify-between items-center">
    <h1 class="text-3xl font-bold text-sassafras">{{ rootbeer.name }}</h1>
    <a href="/rootbeers/{{ rootbeer._id }}" class="text-blue-600 hover:text-blue-800" target="_blank">View Public Page</a>
</div>

<form method="POST" action="/admin/rootbeers/{{ rootbeer._id }}" class="bg-white p-6 rounded-lg shadow space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label for="name" class="block text-sm font-medium mb-2">Name *</label>
            <input type="text" id="name" name="name" value="{{ rootbeer.name }}" required class="form-input">
        </div>
        
        <div>
            <label for="brand" class="block text-sm font-medium mb-2">Brand *</label>
            <input type="text" id="brand" name="brand" value="{{ rootbeer.brand }}" required class="form-input">
        </div>
        
        <div>
            <label for="region" class="block text-sm font-medium mb-2">Region</label>
            <input type="text" id="region" name="region" value="{{ rootbeer.region or '' }}" class="form-input">
        </div>
        
        <div>
            <label for="country" class="block text-sm font-medium mb-2">Country</label>
            <input type="text" id="country" name="country" value="{{ rootbeer.country or '' }}" class="form-input">
        </div>
        
        <div>
            <label for="sweetener_type" class="block text-sm font-medium mb-2">Sweetener Type</label>
            <input type="text" id="sweetener_type" name="sweetener_type" value="{{ rootbeer.sweetener_type or '' }}" class="form-input">
        </div>
        
        <div>
            <label for="sugar_grams_per_serving" class="block text-sm font-medium mb-2">Sugar (g per serving)</label>
            <input type="number" id="sugar_grams_per_serving" name="sugar_grams_per_serving" value="{{ rootbeer.sugar_grams_per_serving or '' }}" step="0.1" min="0" class="form-input">
        </div>
        
        <div>
            <label for="caffeine_mg" class="block text-sm font-medium mb-2">Caffeine (mg)</label>
            <input type="number" id="caffeine_mg" name="caffeine_mg" value="{{ rootbeer.caffeine_mg or '' }}" step="0.1" min="0" class="form-input">
        </div>
        
        <div>
            <label for="alcohol_content" class="block text-sm font-medium mb-2">Alcohol Content (% ABV)</label>
            <input type="number" id="alcohol_content" name="alcohol_content" value="{{ rootbeer.alcohol_content or '' }}" step="0.1" min="0" max="100" class="form-input">
        </div>
        
        <div>
            <label for="color" class="block text-sm font-medium mb-2">Color</label>
            <select id="color" name="color" class="form-select">
                <option value="">Select a color...</option>
                {% for color in colors %}
                <option value="{{ color.name }}" {% if rootbeer.color == color.name %}selected{% endif %}>{{ color.name }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div>
            <label for="carbonation_level" class="block text-sm font-medium mb-2">Carbonation Level</label>
            <select id="carbonation_level" name="carbonation_level" class="form-select">
                <option value="">Select...</option>
                <option value="low" {% if rootbeer.carbonation_level == 'low' %}selected{% endif %}>Low</option>
                <option value="medium" {% if rootbeer.carbonation_level == 'medium' %}selected{% endif %}>Medium</option>
                <option value="high" {% if rootbeer.carbonation_level == 'high' %}selected{% endif %}>High</option>
            </select>
        </div>
        
        <div>
            <label for="estimated_co2_volumes" class="block text-sm font-medium mb-2">Estimated COâ‚‚ Volumes</label>
            <input type="number" id="estimated_co2_volumes" name="estimated_co2_volumes" value="{{ rootbeer.estimated_co2_volumes or '' }}" step="0.1" min="0" max="10" class="form-input">
        </div>
    </div>
    
    <div>
        <label for="ingredients" class="block text-sm font-medium mb-2">Ingredients</label>
        <textarea id="ingredients" name="ingredients" rows="3" class="form-textarea">{{ rootbeer.ingredients or '' }}</textarea>
    </div>
    
    <div>
        <label for="notes" class="block text-sm font-medium mb-2">Notes</label>
        <textarea id="notes" name="notes" rows="3" class="form-textarea">{{ rootbeer.notes or '' }}</textarea>
    </div>
    
    <div class="flex space-x-4">
        <button type="submit" class="btn-primary">Update Root Beer</button>
        <a href="/admin/rootbeers" class="btn-secondary">Back to List</a>
    </div>
</form>

<div class="mt-8 bg-white p-6 rounded-lg shadow">
    <h2 class="text-2xl font-semibold text-sassafras mb-4">Reviews ({{ reviews|length }})</h2>
    {% if reviews %}
    <div class="space-y-4">
        {% for review in reviews %}
        <div class="border-b pb-4">
            <div class="flex justify-between items-start">
                <div>
                    <p class="font-medium">Score: {{ review.overall_score }}/10</p>
                    <p class="text-sm text-gray-600">{{ review.review_date.strftime('%Y-%m-%d') if review.review_date else review.created_at.strftime('%Y-%m-%d') }}</p>
                </div>
                <a href="/admin/reviews/{{ review._id }}" class="text-amber-700 hover:text-amber-800">Edit</a>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-gray-500">No reviews yet. <a href="/admin/reviews/new?rootbeer_id={{ rootbeer._id }}" class="text-amber-700 hover:text-amber-800">Create a review</a>.</p>
    {% endif %}
</div>

<div class="mt-8">
    <form method="POST" action="/admin/rootbeers/{{ rootbeer._id }}/delete" onsubmit="return confirm('Are you sure you want to delete this root beer? This action cannot be undone.');">
        <button type="submit" class="btn-danger">Delete Root Beer</button>
    </form>
</div>
{% endblock %}

